<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Calculadora Financiera</title>
  <style>
  body {
    font-family: 'Arial', sans-serif;
    margin: 20px;
    background-color: #f9f9f9;
    color: #111827;
  }

  form {
    background: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.1);
  }

  fieldset {
    border: none;
    margin-bottom: 20px;
  }

  legend {
    font-size: 1.2em;
    font-weight: bold;
    margin-bottom: 10px;
  }

  label {
    display: block;
    margin: 10px 0 4px;
    font-weight: bold;
    position: relative; /* necesario para tooltip */
  }

  input[type="number"],
  input[type="text"],
  input[type="email"],
  select {
    width: 100%;
    padding: 10px;
    margin-bottom: 12px;
    border-radius: 8px;
    border: 1px solid #ccc;
    box-sizing: border-box;
    font-size: 1rem;
  }

  /* Tooltips actualizados */
  .tooltip {
    display: inline-block;
    position: relative;
    cursor: pointer;
    font-weight: normal;
    margin-left: 6px;
    color: #2563eb;
    font-size: 1rem;
  }

  .tooltip::after {
    content: attr(title);
    position: absolute;
    bottom: 125%; /* tooltip arriba del ícono */
    left: 50%;
    transform: translateX(-50%);
    background-color: #111827;
    color: #fff;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 0.85rem;
    white-space: normal;
    width: 220px;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s;
    z-index: 10;
    text-align: center;
  }

  .tooltip:hover::after {
    opacity: 1;
    visibility: visible;
  }

  /* Navegador top */
  #topNav {
    width: 100%;
    margin-bottom: 20px;
  }

  .top-navigation {
    display: flex;
    flex-wrap: nowrap;
    justify-content: center;
    gap: 10px;
  }

  .nav-btn {
    padding: 12px 24px;
    border: 2px solid #2563eb;
    background-color: white;
    color: #2563eb;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.3s, color 0.3s;
    min-width: 120px;
    text-align: center;
  }

  .nav-btn.active {
    background-color: #2563eb;
    color: white;
  }

  .nav-btn:hover {
    background-color: #1d4ed8;
    color: white;
  }

  .step {
    display: none;
  }

  .step.active {
    display: block;
  }

  .nav-buttons {
    margin-top: 20px;
  }

  /* Asterisco rojo para campos requeridos */
  .required-label::after {
    content: " *";
    color: red;
    font-weight: bold;
    margin-left: 4px;
  }

  @media (max-width: 768px) {
    .top-navigation {
      flex-wrap: wrap;
    }
    .tooltip::after {
      width: 180px;
    }
  }
      .required-label::after {
    content: " *";
    color: red;
    font-weight: bold;
    margin-left: 4px;
  }

  .required-label.error {
    color: #dc2626;
  }

  /* Efecto shake */
  @keyframes shake {
    0% { transform: translateX(0); }
    25% { transform: translateX(-4px); }
    50% { transform: translateX(4px); }
    75% { transform: translateX(-4px); }
    100% { transform: translateX(0); }
  }

  .shake {
    animation: shake 0.3s;
    animation-iteration-count: 1;
  }
        /* 🌟 Botón grande azul estilo 'Continuar' */
button {
  background-color: #2563eb; /* Azul principal */
  color: white;
  padding: 14px 28px; /* Botón grande */
  font-size: 1.1rem;
  font-weight: bold;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  width: 100%; /* Que ocupe todo el ancho disponible */
  transition: background-color 0.3s, transform 0.2s; /* Efecto hover y efecto click */
}

button:hover {
  background-color: #1d4ed8; /* Azul un poco más oscuro al pasar el mouse */
}

button:active {
  transform: scale(0.98); /* Pequeño efecto de 'presionado' al hacer click */
}
  </style>
</head>

<body>

<!-- Navegador superior -->
<div id="topNav" class="top-navigation">
  <button class="nav-btn active" onclick="irASeccion('stepIngresos')">Ingresos</button>
  <button class="nav-btn" onclick="irASeccion('stepGastos')">Gastos</button>
  <button class="nav-btn" onclick="irASeccion('stepActivos')">Activos</button>
  <button class="nav-btn" onclick="irASeccion('stepPasivos')">Pasivos</button>
  <button class="nav-btn" onclick="irASeccion('stepSegurosHerencia')">Seguros y Herencia</button>
  <button class="nav-btn" onclick="irASeccion('stepRetiro')">Retiro</button>
</div>

<!-- Formulario -->
<div id="formularioContainer">
  <form id="calculadoraFormulario">

    <!-- 1. Ingresos -->
<div class="step" id="stepIngresos">
  <fieldset>
    <legend>Ingresos y Ahorros</legend>

    <label>Ingreso anual bruto
      <span class="tooltip" title="Suma total de ingresos antes de impuestos: salario, negocio, bonos, dividendos, rentas, etc.">🛈</span>
    </label>
    <input type="number" name="ingreso_bruto" required onblur="validarCampo(this)">

    <label>Aporte personal a retiro
      <span class="tooltip" title="Aporte que realizas de tu salario hacia tu fondo de retiro 401k, IRA, o similar.">🛈</span>
    </label>
    <input type="number" name="aporte_personal_retiro" required onblur="validarCampo(this)">

    <label>Aporte del empleador a retiro
      <span class="tooltip" title="Aporte que tu empleador realiza a tu fondo de retiro, si aplica.">🛈</span>
    </label>
    <input type="number" name="aporte_empleador_retiro" required onblur="validarCampo(this)">

    <label>Otros ahorros
      <span class="tooltip" title="Cualquier otra forma de ahorro anual: ahorro bancario, fondos de emergencia, etc.">🛈</span>
    </label>
    <input type="number" name="otros_ahorros" required onblur="validarCampo(this)">

  </fieldset>
  <div class="nav-buttons">
    <button type="button" onclick="guardarDatosYAvanzar('stepGastos')">Continuar</button>
  </div>
</div>

    <!-- 2. Gastos -->
<div class="step" id="stepGastos">
  <fieldset>
    <legend>Gastos Anuales</legend>

    <label>Pago por deudas
      <span class="tooltip" title="Pagos anuales de hipotecas, préstamos personales, automotrices, educativos y tarjetas de crédito.">🛈</span>
    </label>
    <input type="number" name="pago_deudas" required onblur="validarCampo(this)">

    <label>Gastos diarios esenciales
      <span class="tooltip" title="Incluye supermercado, transporte, servicios públicos, telecomunicaciones y mantenimiento básico.">🛈</span>
    </label>
    <input type="number" name="gastos_diarios" required onblur="validarCampo(this)">

    <label>Impuestos anuales
      <span class="tooltip" title="Pagos de impuestos federales, estatales, municipales, de propiedad y de vehículo.">🛈</span>
    </label>
    <input type="number" name="impuestos_anuales" required onblur="validarCampo(this)">

    <label>Seguros anuales
      <span class="tooltip" title="Pagos de seguros de salud, vida, propiedad, auto y umbrella.">🛈</span>
    </label>
    <input type="number" name="seguros_anuales" required onblur="validarCampo(this)">

  </fieldset>
  <div class="nav-buttons">
    <button type="button" onclick="guardarDatosYAvanzar('stepActivos')">Continuar</button>
  </div>
</div>

<!-- 3. Activos -->
<div class="step" id="stepActivos">
  <fieldset>
    <legend>Activos</legend>

    <label>Efectivo y similares
      <span class="tooltip" title="Saldos en cuentas bancarias, efectivo disponible, cuentas de ahorro o money market.">🛈</span>
    </label>
    <input type="number" name="efectivo_similar" required onblur="validarCampo(this)">

    <label>Cuentas de inversión (no retiro)
      <span class="tooltip" title="Valor de inversiones líquidas no destinadas a retiro: fondos mutuos, acciones, bonos.">🛈</span>
    </label>
    <input type="number" name="cuentas_inversion" required onblur="validarCampo(this)">

    <label>Cuentas de retiro
      <span class="tooltip" title="Valor actual de tus cuentas IRA, 401(k), Roth, 403(b) o planes similares.">🛈</span>
    </label>
    <input type="number" name="cuentas_retiro" required onblur="validarCampo(this)">

    <label>Propiedades
      <span class="tooltip" title="Valor de mercado de propiedades residenciales o de inversión que poseas.">🛈</span>
    </label>
    <input type="number" name="valor_propiedades" required onblur="validarCampo(this)">

    <label>Otros activos
      <span class="tooltip" title="Valor estimado de autos, joyas, metales preciosos, muebles valiosos, arte, etc.">🛈</span>
    </label>
    <input type="number" name="otros_activos" required onblur="validarCampo(this)">

  </fieldset>
  <div class="nav-buttons">
    <button type="button" onclick="guardarDatosYAvanzar('stepPasivos')">Continuar</button>
  </div>
</div>

    <!-- 4. Pasivos -->
<div class="step" id="stepPasivos">
  <fieldset>
    <legend>Pasivos</legend>

    <label>Deuda de tarjetas de crédito
      <span class="tooltip" title="Saldo total actual de todas tus tarjetas de crédito.">🛈</span>
    </label>
    <input type="number" name="deuda_tarjetas" required onblur="validarCampo(this)">

    <label>Hipoteca o préstamo de vivienda
      <span class="tooltip" title="Saldo pendiente de tu hipoteca principal o préstamo de vivienda.">🛈</span>
    </label>
    <input type="number" name="deuda_hipotecaria" required onblur="validarCampo(this)">

    <label>Deuda comercial
      <span class="tooltip" title="Saldo actual de préstamos comerciales si eres dueño de un negocio.">🛈</span>
    </label>
    <input type="number" name="deuda_comercial" required onblur="validarCampo(this)">

    <label>Préstamos de vehículos
      <span class="tooltip" title="Saldo pendiente de tus préstamos de autos, motocicletas u otros vehículos.">🛈</span>
    </label>
    <input type="number" name="deuda_vehiculos" required onblur="validarCampo(this)">

    <label>Deuda estudiantil
      <span class="tooltip" title="Saldo restante de tus préstamos educativos o universitarios.">🛈</span>
    </label>
    <input type="number" name="deuda_estudios" required onblur="validarCampo(this)">

    <label>Otras deudas
      <span class="tooltip" title="Cualquier otro saldo de deuda no clasificada anteriormente.">🛈</span>
    </label>
    <input type="number" name="deuda_otros" required onblur="validarCampo(this)">

  </fieldset>
  <div class="nav-buttons">
    <button type="button" onclick="guardarDatosYAvanzar('stepSegurosHerencia')">Continuar</button>
  </div>
</div>

<!-- 5. Seguros y Herencia -->
<div class="step" id="stepSegurosHerencia">
  <fieldset>
    <legend>Seguros y planificación patrimonial</legend>

    <h4>Seguros:</h4>

    <label>
      <input type="checkbox" name="seguro_vida">
      Seguro de vida <span class="tooltip" title="Seguro que paga una suma de dinero a los beneficiarios en caso de fallecimiento.">🛈</span>
    </label>

    <label>
      <input type="checkbox" name="seguro_salud">
      Seguro de salud <span class="tooltip" title="Seguro que cubre gastos médicos, hospitalarios y de tratamiento de salud.">🛈</span>
    </label>

    <label>
      <input type="checkbox" name="seguro_incapacidad">
      Seguro de incapacidad <span class="tooltip" title="Proporciona ingresos en caso de discapacidad temporal o permanente que impida trabajar.">🛈</span>
    </label>

    <label>
      <input type="checkbox" name="seguro_ltc">
      Seguro de cuidado a largo plazo <span class="tooltip" title="Cubre gastos de asistencia a largo plazo como residencias asistidas o servicios de cuidado en casa.">🛈</span>
    </label>

    <label>
      <input type="checkbox" name="seguro_propiedad">
      Seguro de propiedad <span class="tooltip" title="Protege contra daños a viviendas o propiedades personales debido a incendios, robos u otros desastres.">🛈</span>
    </label>

    <label>
      <input type="checkbox" name="seguro_auto">
      Seguro de auto <span class="tooltip" title="Cubre daños al vehículo, responsabilidad civil y lesiones relacionadas con accidentes de tránsito.">🛈</span>
    </label>

    <label>
      <input type="checkbox" name="seguro_umbrella">
      Seguro umbrella <span class="tooltip" title="Ofrece cobertura de responsabilidad adicional más allá de las pólizas de hogar o auto.">🛈</span>
    </label>

    <label>
      <input type="checkbox" name="ningun_seguro">
      ❌ No tengo seguros actualmente
    </label>

    <br><br>

    <h4>Documentos de herencia:</h4>

    <label>
      <input type="checkbox" name="trust">
      Trust <span class="tooltip" title="Documento que transfiere activos a un fideicomiso para ser administrados según tus instrucciones.">🛈</span>
    </label>

    <label>
      <input type="checkbox" name="will">
      Testamento <span class="tooltip" title="Documento legal que establece cómo deseas distribuir tus activos después de tu muerte.">🛈</span>
    </label>

    <label>
      <input type="checkbox" name="advance_medical_directive">
      Directiva médica anticipada <span class="tooltip" title="Instrucciones sobre decisiones médicas a tomar en caso de incapacidad.">🛈</span>
    </label>

    <label>
      <input type="checkbox" name="power_of_attorney">
      Poder legal <span class="tooltip" title="Autoriza a alguien a actuar legalmente en tu nombre en asuntos financieros o médicos.">🛈</span>
    </label>

    <label>
      <input type="checkbox" name="beneficiary_designation">
      Designación de beneficiarios <span class="tooltip" title="Documentos que asignan beneficiarios para pólizas de seguros o cuentas financieras.">🛈</span>
    </label>

    <label>
      <input type="checkbox" name="property_deeds">
      Títulos de propiedad <span class="tooltip" title="Documentos oficiales que prueban la propiedad de inmuebles o bienes raíces.">🛈</span>
    </label>

    <label>
      <input type="checkbox" name="ningun_documento">
      ❌ No tengo documentos de planificación patrimonial
    </label>

  </fieldset>

  <div class="nav-buttons">
   <button type="button" onclick="guardarDatosSegurosHerencia()">Continuar</button>
  </div>
</div>


    <!-- 6. Retiro -->
<div class="step" id="stepRetiro">
  <fieldset>
    <legend>Planificación de retiro</legend>

    <label>Edad actual
      <span class="tooltip" title="Tu edad en este momento. Es el punto de partida para calcular tu plan de retiro.">🛈</span>
    </label>
    <input type="number" name="edad" required onblur="validarCampo(this)">

    <label>Edad deseada de retiro
      <span class="tooltip" title="La edad a la cual planeas retirarte. Comúnmente entre 60 y 70 años.">🛈</span>
    </label>
    <input type="number" name="edad_retiro" required onblur="validarCampo(this)">

    <label>Tasa esperada de acumulación (%) 
      <span class="tooltip" title="Tasa de crecimiento promedio anual de tus inversiones hasta el retiro. Ejemplo típico: 7%-10%.">🛈</span>
    </label>
    <input type="number" name="tasa_acumulacion" step="0.01" required onblur="validarCampo(this)">

    <label>Inflación estimada (%) 
      <span class="tooltip" title="Incremento promedio esperado de los precios cada año. Ejemplo típico: 2%-3%.">🛈</span>
    </label>
    <input type="number" name="inflacion_esperada" step="0.01" required onblur="validarCampo(this)">

    <label>Tasa estimada durante retiro (%) 
      <span class="tooltip" title="Rendimiento esperado de tus inversiones después de retirarte. Ejemplo típico: 3%-5%.">🛈</span>
    </label>
    <input type="number" name="tasa_retiro" step="0.01" required onblur="validarCampo(this)">

    <!-- Tasa de reemplazo oculta -->
    <input type="hidden" name="porcentaje_reemplazo" value="70">

  </fieldset>
  <div class="nav-buttons">
    <button type="submit">Calcular</button>
  </div>
</div>


<!-- Script para navegación -->

<script>
// ✅ Ocultar todas las secciones
function ocultarTodasLasSecciones() {
  document.querySelectorAll('.step').forEach(div => {
    div.classList.remove('active');
    div.style.display = "none";
  });
}

// ✅ Ir a una sección específica
function irASeccion(stepId) {
  ocultarTodasLasSecciones();

  const step = document.getElementById(stepId);
  if (step) {
    step.classList.add('active');
    step.style.display = "block";
  }

  document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
  const buttons = document.querySelectorAll('.nav-btn');
  const index = {
    stepIngresos: 0,
    stepGastos: 1,
    stepActivos: 2,
    stepPasivos: 3,
    stepSegurosHerencia: 4,
    stepRetiro: 5
  }[stepId];
  if (buttons[index]) buttons[index].classList.add('active');
  
  seccionActual = stepId; // 🔥 Muy importante para bloquear navegación manual
}

// ✅ Bloqueador de navegación por top menú
let seccionActual = 'stepIngresos'; // Comenzamos en Ingresos

document.querySelectorAll('.nav-btn').forEach(btn => {
  btn.addEventListener('click', function (e) {
    const destino = this.getAttribute('onclick').match(/'(.*?)'/)[1];

    if (destino !== seccionActual) {
      e.preventDefault();
    }
  });
});

// ✅ Validar campos antes de avanzar
function guardarDatosYAvanzar(siguientePasoId) {
  const pasoActual = document.querySelector('.step.active');
  let camposValidos = true;

  if (pasoActual) {
    const inputs = pasoActual.querySelectorAll('input[required]');
    
    inputs.forEach(input => {
      const label = input.previousElementSibling;
      if (input.value.trim() === '' || isNaN(input.value) || parseFloat(input.value) < 0) {
        camposValidos = false;
        input.style.border = '2px solid red';
        if (label) {
          label.classList.add('error');
          label.classList.add('shake');
          setTimeout(() => label.classList.remove('shake'), 400); // ✨ Shake más elegante
        }
      } else {
        input.style.border = '2px solid green';
        if (label) {
          label.classList.remove('error');
        }
      }
    });
  }

  if (camposValidos) {
    irASeccion(siguientePasoId);
  }
}

// ✅ Retroceder sin validar
function prevStep(prevPasoId) {
  irASeccion(prevPasoId);
}

// ✅ Al cargar la página
window.onload = function() {
  ocultarTodasLasSecciones();
  const step = document.getElementById('stepIngresos');
  if (step) {
    step.classList.add('active');
    step.style.display = "block";
  }
  seccionActual = 'stepIngresos';
};

// ✅ Agregar 'required-label' automáticamente a los labels de inputs required
document.addEventListener('DOMContentLoaded', function() {
  const inputsRequeridos = document.querySelectorAll('input[required]');
  inputsRequeridos.forEach(input => {
    const label = input.previousElementSibling;
    if (label && label.tagName.toLowerCase() === 'label') {
      label.classList.add('required-label');
    }
  });
});

// ✅ Validar Seguros y Herencia antes de pasar
function guardarDatosSegurosHerencia() {
  const segurosSeleccionados = document.querySelectorAll('input[name^="seguro_"]:checked');
  const ningunSeguro = document.querySelector('input[name="ningun_seguro"]:checked');

  const documentosSeleccionados = document.querySelectorAll('input[name="trust"]:checked, input[name="will"]:checked, input[name="advance_medical_directive"]:checked, input[name="power_of_attorney"]:checked, input[name="beneficiary_designation"]:checked, input[name="property_deeds"]:checked');
  const ningunDocumento = document.querySelector('input[name="ningun_documento"]:checked');

  let error = false;

  if (segurosSeleccionados.length === 0 && !ningunSeguro) {
    error = true;
  }
  if (documentosSeleccionados.length === 0 && !ningunDocumento) {
    error = true;
  }

  const container = document.getElementById('stepSegurosHerencia');

  if (error) {
    container.classList.add('shake');
    container.querySelector('fieldset').style.border = '2px solid red';
    setTimeout(() => {
      container.classList.remove('shake');
    }, 400); // ✨ Shake más suave
  } else {
    container.querySelector('fieldset').style.border = 'none';
    irASeccion('stepRetiro');
  }
}

</script>


</body>
</html>
