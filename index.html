<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <title>Calculadora Financiera</title>
  
  <!-- ConexiÃ³n al CSS externo -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- Navegador superior -->
<div id="topNav" class="top-navigation">
  <button class="nav-btn active" onclick="irASeccion('stepIngresos')">Ingresos</button>
  <button class="nav-btn" onclick="irASeccion('stepGastos')">Gastos</button>
  <button class="nav-btn" onclick="irASeccion('stepActivos')">Activos</button>
  <button class="nav-btn" onclick="irASeccion('stepPasivos')">Pasivos</button>
  <button class="nav-btn" onclick="irASeccion('stepSegurosHerencia')">Seguros y Herencia</button>
  <button class="nav-btn" onclick="irASeccion('stepRetiro')">Retiro</button>
</div>

<!-- Formulario -->
<div id="formularioContainer">
  <form id="calculadoraFormulario">

<!-- 1. Ingresos -->
<div class="step" id="stepIngresos">
  <fieldset>
    <legend>Ingresos y Ahorros</legend>

    <label for="ingreso_bruto">Ingreso anual bruto
      <span class="tooltip" data-tooltip="Suma total de ingresos antes de impuestos: salario, negocio, bonos, dividendos, rentas, etc.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="ingreso_bruto" name="ingreso_bruto" required onblur="validarCampo(this)">

    <label for="aporte_personal_retiro">Aporte personal a retiro
      <span class="tooltip" data-tooltip="Aporte que realizas de tu salario hacia tu fondo de retiro 401k, IRA, o similar.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="aporte_personal_retiro" name="aporte_personal_retiro" required onblur="validarCampo(this)">

    <label for="aporte_empleador_retiro">Aporte del empleador a retiro
      <span class="tooltip" data-tooltip="Aporte que tu empleador realiza a tu fondo de retiro, si aplica.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="aporte_empleador_retiro" name="aporte_empleador_retiro" required onblur="validarCampo(this)">

    <label for="otros_ahorros">Otros ahorros
      <span class="tooltip" data-tooltip="Cualquier otra forma de ahorro anual: ahorro bancario, fondos de emergencia, etc.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="otros_ahorros" name="otros_ahorros" required onblur="validarCampo(this)">

  </fieldset>
  <div class="nav-buttons">
    <button type="button" onclick="guardarDatosYAvanzar('stepGastos')">Continuar</button>
  </div>
</div>

<!-- 2. Gastos -->
<div class="step" id="stepGastos">
  <fieldset>
    <legend>Gastos Anuales</legend>

    <label for="pago_deudas">Pago por deudas
      <span class="tooltip" data-tooltip="Pagos anuales de hipotecas, prÃ©stamos personales, automotrices, educativos y tarjetas de crÃ©dito.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="pago_deudas" name="pago_deudas" required onblur="validarCampo(this)">

    <label for="gastos_diarios">Gastos diarios esenciales
      <span class="tooltip" data-tooltip="Incluye supermercado, transporte, servicios pÃºblicos, telecomunicaciones y mantenimiento bÃ¡sico.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="gastos_diarios" name="gastos_diarios" required onblur="validarCampo(this)">

    <label for="impuestos_anuales">Impuestos anuales
      <span class="tooltip" data-tooltip="Pagos de impuestos federales, estatales, municipales, de propiedad y de vehÃ­culo.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="impuestos_anuales" name="impuestos_anuales" required onblur="validarCampo(this)">

    <label for="seguros_anuales">Seguros anuales
      <span class="tooltip" data-tooltip="Pagos de seguros de salud, vida, propiedad, auto y umbrella.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="seguros_anuales" name="seguros_anuales" required onblur="validarCampo(this)">

  </fieldset>
  <div class="nav-buttons">
    <button type="button" onclick="guardarDatosYAvanzar('stepActivos')">Continuar</button>
  </div>
</div>

    <!-- 3. Activos -->
<div class="step" id="stepActivos">
  <fieldset>
    <legend>Activos</legend>

    <label for="efectivo_similar">Efectivo y similares
      <span class="tooltip" data-tooltip="Saldos en cuentas bancarias, efectivo disponible, cuentas de ahorro o money market.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="efectivo_similar" name="efectivo_similar" required onblur="validarCampo(this)">

    <label for="cuentas_inversion">Cuentas de inversiÃ³n (no retiro)
      <span class="tooltip" data-tooltip="Valor de inversiones lÃ­quidas no destinadas a retiro: fondos mutuos, acciones, bonos.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="cuentas_inversion" name="cuentas_inversion" required onblur="validarCampo(this)">

    <label for="cuentas_retiro">Cuentas de retiro
      <span class="tooltip" data-tooltip="Valor actual de tus cuentas IRA, 401(k), Roth, 403(b) o planes similares.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="cuentas_retiro" name="cuentas_retiro" required onblur="validarCampo(this)">

    <label for="valor_propiedades">Propiedades
      <span class="tooltip" data-tooltip="Valor de mercado de propiedades residenciales o de inversiÃ³n que poseas.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="valor_propiedades" name="valor_propiedades" required onblur="validarCampo(this)">

    <label for="otros_activos">Otros activos
      <span class="tooltip" data-tooltip="Valor estimado de autos, joyas, metales preciosos, muebles valiosos, arte, etc.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="otros_activos" name="otros_activos" required onblur="validarCampo(this)">

  </fieldset>
  <div class="nav-buttons">
    <button type="button" onclick="guardarDatosYAvanzar('stepPasivos')">Continuar</button>
  </div>
</div>

<!-- 4. Pasivos -->
<div class="step" id="stepPasivos">
  <fieldset>
    <legend>Pasivos</legend>

    <label for="deuda_tarjetas">Deuda de tarjetas de crÃ©dito
      <span class="tooltip" data-tooltip="Saldo total actual de todas tus tarjetas de crÃ©dito.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="deuda_tarjetas" name="deuda_tarjetas" required onblur="validarCampo(this)">

    <label for="deuda_hipotecaria">Hipoteca o prÃ©stamo de vivienda
      <span class="tooltip" data-tooltip="Saldo pendiente de tu hipoteca principal o prÃ©stamo de vivienda.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="deuda_hipotecaria" name="deuda_hipotecaria" required onblur="validarCampo(this)">

    <label for="deuda_comercial">Deuda comercial
      <span class="tooltip" data-tooltip="Saldo actual de prÃ©stamos comerciales si eres dueÃ±o de un negocio.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="deuda_comercial" name="deuda_comercial" required onblur="validarCampo(this)">

    <label for="deuda_vehiculos">PrÃ©stamos de vehÃ­culos
      <span class="tooltip" data-tooltip="Saldo pendiente de tus prÃ©stamos de autos, motocicletas u otros vehÃ­culos.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="deuda_vehiculos" name="deuda_vehiculos" required onblur="validarCampo(this)">

    <label for="deuda_estudios">Deuda estudiantil
      <span class="tooltip" data-tooltip="Saldo restante de tus prÃ©stamos educativos o universitarios.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="deuda_estudios" name="deuda_estudios" required onblur="validarCampo(this)">

    <label for="deuda_otros">Otras deudas
      <span class="tooltip" data-tooltip="Cualquier otro saldo de deuda no clasificada anteriormente.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="deuda_otros" name="deuda_otros" required onblur="validarCampo(this)">

  </fieldset>
  <div class="nav-buttons">
    <button type="button" onclick="guardarDatosYAvanzar('stepSegurosHerencia')">Continuar</button>
  </div>
</div>

<!-- 5. Seguros y Herencia -->
<div class="step" id="stepSegurosHerencia">
  <fieldset>
    <legend>Seguros y planificaciÃ³n patrimonial</legend>

    <h4>Seguros:</h4>

    <label for="seguro_vida">
      <input type="checkbox" id="seguro_vida" name="seguro_vida">
      Seguro de vida <span class="tooltip" data-tooltip="Seguro que paga una suma de dinero a los beneficiarios en caso de fallecimiento.">ğŸ›ˆ</span>
    </label>

    <label for="seguro_salud">
      <input type="checkbox" id="seguro_salud" name="seguro_salud">
      Seguro de salud <span class="tooltip" data-tooltip="Seguro que cubre gastos mÃ©dicos, hospitalarios y de tratamiento de salud.">ğŸ›ˆ</span>
    </label>

    <label for="seguro_incapacidad">
      <input type="checkbox" id="seguro_incapacidad" name="seguro_incapacidad">
      Seguro de incapacidad <span class="tooltip" data-tooltip="Proporciona ingresos en caso de discapacidad temporal o permanente que impida trabajar.">ğŸ›ˆ</span>
    </label>

    <label for="seguro_ltc">
      <input type="checkbox" id="seguro_ltc" name="seguro_ltc">
      Seguro de cuidado a largo plazo <span class="tooltip" data-tooltip="Cubre gastos de asistencia a largo plazo como residencias asistidas o servicios de cuidado en casa.">ğŸ›ˆ</span>
    </label>

    <label for="seguro_propiedad">
      <input type="checkbox" id="seguro_propiedad" name="seguro_propiedad">
      Seguro de propiedad <span class="tooltip" data-tooltip="Protege contra daÃ±os a viviendas o propiedades personales debido a incendios, robos u otros desastres.">ğŸ›ˆ</span>
    </label>

    <label for="seguro_auto">
      <input type="checkbox" id="seguro_auto" name="seguro_auto">
      Seguro de auto <span class="tooltip" data-tooltip="Cubre daÃ±os al vehÃ­culo, responsabilidad civil y lesiones relacionadas con accidentes de trÃ¡nsito.">ğŸ›ˆ</span>
    </label>

    <label for="seguro_umbrella">
      <input type="checkbox" id="seguro_umbrella" name="seguro_umbrella">
      Seguro umbrella <span class="tooltip" data-tooltip="Ofrece cobertura de responsabilidad adicional mÃ¡s allÃ¡ de las pÃ³lizas de hogar o auto.">ğŸ›ˆ</span>
    </label>

    <label for="ningun_seguro">
      <input type="checkbox" id="ningun_seguro" name="ningun_seguro">
      âŒ No tengo seguros actualmente
    </label>

    <br><br>

    <h4>Documentos de herencia:</h4>

    <label for="trust">
      <input type="checkbox" id="trust" name="trust">
      Trust <span class="tooltip" data-tooltip="Documento que transfiere activos a un fideicomiso para ser administrados segÃºn tus instrucciones.">ğŸ›ˆ</span>
    </label>

    <label for="will">
      <input type="checkbox" id="will" name="will">
      Testamento <span class="tooltip" data-tooltip="Documento legal que establece cÃ³mo deseas distribuir tus activos despuÃ©s de tu muerte.">ğŸ›ˆ</span>
    </label>

    <label for="advance_medical_directive">
      <input type="checkbox" id="advance_medical_directive" name="advance_medical_directive">
      Directiva mÃ©dica anticipada <span class="tooltip" data-tooltip="Instrucciones sobre decisiones mÃ©dicas a tomar en caso de incapacidad.">ğŸ›ˆ</span>
    </label>

    <label for="power_of_attorney">
      <input type="checkbox" id="power_of_attorney" name="power_of_attorney">
      Poder legal <span class="tooltip" data-tooltip="Autoriza a alguien a actuar legalmente en tu nombre en asuntos financieros o mÃ©dicos.">ğŸ›ˆ</span>
    </label>

    <label for="beneficiary_designation">
      <input type="checkbox" id="beneficiary_designation" name="beneficiary_designation">
      DesignaciÃ³n de beneficiarios <span class="tooltip" data-tooltip="Documentos que asignan beneficiarios para pÃ³lizas de seguros o cuentas financieras.">ğŸ›ˆ</span>
    </label>

    <label for="property_deeds">
      <input type="checkbox" id="property_deeds" name="property_deeds">
      TÃ­tulos de propiedad <span class="tooltip" data-tooltip="Documentos oficiales que prueban la propiedad de inmuebles o bienes raÃ­ces.">ğŸ›ˆ</span>
    </label>

    <label for="ningun_documento">
      <input type="checkbox" id="ningun_documento" name="ningun_documento">
      âŒ No tengo documentos de planificaciÃ³n patrimonial
    </label>

  </fieldset>

  <div class="nav-buttons">
    <button type="button" onclick="guardarDatosSegurosHerencia()">Continuar</button>
  </div>
</div>

<!-- 6. Retiro -->
<div class="step" id="stepRetiro">
  <fieldset>
    <legend>PlanificaciÃ³n de retiro</legend>

    <label for="edad">
      Edad actual
      <span class="tooltip" data-tooltip="Tu edad en este momento. Es el punto de partida para calcular tu plan de retiro.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="edad" name="edad" required onblur="validarCampo(this)">

    <label for="edad_retiro">
      Edad deseada de retiro
      <span class="tooltip" data-tooltip="La edad a la cual planeas retirarte. ComÃºnmente entre 60 y 70 aÃ±os.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="edad_retiro" name="edad_retiro" required onblur="validarCampo(this)">

    <label for="tasa_acumulacion">
      Tasa esperada de acumulaciÃ³n (%) 
      <span class="tooltip" data-tooltip="Tasa de crecimiento promedio anual de tus inversiones hasta el retiro. Ejemplo tÃ­pico: 7%-10%.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="tasa_acumulacion" name="tasa_acumulacion" step="0.01" required onblur="validarCampo(this)">

    <label for="inflacion_esperada">
      InflaciÃ³n estimada (%) 
      <span class="tooltip" data-tooltip="Incremento promedio esperado de los precios cada aÃ±o. Ejemplo tÃ­pico: 2%-3%.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="inflacion_esperada" name="inflacion_esperada" step="0.01" required onblur="validarCampo(this)">

    <label for="tasa_retiro">
      Tasa estimada durante retiro (%) 
      <span class="tooltip" data-tooltip="Rendimiento esperado de tus inversiones despuÃ©s de retirarte. Ejemplo tÃ­pico: 3%-5%.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="tasa_retiro" name="tasa_retiro" step="0.01" required onblur="validarCampo(this)">

    <!-- Tasa de reemplazo oculta -->
    <input type="hidden" name="porcentaje_reemplazo" value="70">

  </fieldset>

<div class="nav-buttons">
  <button type="button" onclick="mostrarResultadosFinales()">Calcular</button>
</div>

<!-- ğŸ”µ Contenedor de Resultados -->
<div id="resultadosContainer" style="display: none; margin-top: 40px;">

  <!-- ğŸ”µ Navegador de resultados -->
  <div id="navResultados" class="top-navigation">
    <button class="nav-btn active" onclick="mostrarResultado('resA')">ğŸ…°ï¸ Flujo</button>
    <button class="nav-btn" onclick="mostrarResultado('resB')">ğŸ…±ï¸ Deuda</button>
    <button class="nav-btn" onclick="mostrarResultado('resC')">ğŸ…² Patrimonio</button>
    <button class="nav-btn" onclick="mostrarResultado('resD')">ğŸ…³ Seguridad</button>
    <button class="nav-btn" onclick="mostrarResultado('resE')">ğŸ…´ Riesgo</button>
    <button class="nav-btn" onclick="mostrarResultado('resF')">ğŸ…µ Patrimonial</button>
    <button class="nav-btn" onclick="mostrarResultado('resG')">ğŸ…¶ Retiro</button>
    <button class="nav-btn" onclick="mostrarResultado('resH')">ğŸ…· EstrÃ©s</button>
  </div>

  <!-- ğŸ”µ Secciones individuales -->
<div id="resA" class="resultado-categoria"> <!-- inicia visible -->
  <h3>ğŸ…°ï¸ Flujo de efectivo</h3>
  <p id="flujo">Resultados de flujo aquÃ­...</p>

  <!-- ğŸ”µ GrÃ¡fica de gastos -->
  <canvas id="graficoGastos" style="max-width: 400px; margin-top: 20px;"></canvas>
</div>

  <div id="resB" class="resultado-categoria" style="display: none;">
    <h3>ğŸ…±ï¸ Endeudamiento</h3>
    <p>Resultados de deuda aquÃ­...</p>
  </div>

  <div id="resC" class="resultado-categoria" style="display: none;">
    <h3>ğŸ…² Patrimonio neto</h3>
    <p>Resultados de patrimonio aquÃ­...</p>
  </div>

  <div id="resD" class="resultado-categoria" style="display: none;">
    <h3>ğŸ…³ Seguridad financiera</h3>
    <p>Resultados de seguridad aquÃ­...</p>
  </div>

  <div id="resE" class="resultado-categoria" style="display: none;">
    <h3>ğŸ…´ Manejo de riesgo</h3>
    <p>Resultados de riesgo aquÃ­...</p>
  </div>

  <div id="resF" class="resultado-categoria" style="display: none;">
    <h3>ğŸ…µ PlanificaciÃ³n patrimonial</h3>
    <p>Resultados de planificaciÃ³n aquÃ­...</p>
  </div>

<div id="resG" class="resultado-categoria" style="display: none;">
  <h3>ğŸ…¶ Retiro</h3>
  <p id="retiroTexto">Resultados de retiro aquÃ­...</p>
  <canvas id="graficoRetiro" style="max-width: 600px; margin-top: 30px;"></canvas>
</div>

  <div id="resH" class="resultado-categoria" style="display: none;">
    <h3>ğŸ…· Pruebas de estrÃ©s</h3>
    <p>Resultados de estrÃ©s aquÃ­...</p>
  </div>

</div>
    <script>
function renderGraficoRetiro(capitalNecesario, capitalAcumulado) {
  const ctx = document.getElementById('graficoRetiro').getContext('2d');
  if (window.graficoRetiroInstance) {
    window.graficoRetiroInstance.destroy();
  }

  window.graficoRetiroInstance = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['ğŸ§± Capital necesario', 'ğŸ’¼ Capital acumulado'],
      datasets: [{
        label: 'Monto en USD',
        data: [capitalNecesario, capitalAcumulado],
        backgroundColor: ['#f87171', '#4ade80'],
        borderRadius: 6,
        barThickness: 40
      }]
    },
    options: {
      indexAxis: 'y',
      plugins: {
        legend: { display: false },
        tooltip: {
          callbacks: {
            label: context => `$${context.raw.toLocaleString()}`
          }
        }
      },
      scales: {
        x: {
          beginAtZero: true,
          ticks: {
            callback: value => `$${value.toLocaleString()}`
          }
        },
        y: {
          ticks: {
            font: {
              size: 14,
              weight: 'bold'
            }
          }
        }
      }
    }
  });
}
</script>
    <script src="script.js" defer></script>
</body>
</html>

