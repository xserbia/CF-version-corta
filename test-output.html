<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <title>Calculadora Financiera</title>
  <!-- ConexiÃ³n al CSS externo -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
<!-- ğŸ” NavegaciÃ³n superior -->
<div id="topNav" class="top-navigation">
  <button class="nav-btn active" onclick="irASeccion('stepIngresos')">Ingreso</button>
  <button id="btnGastos" class="nav-btn" onclick="validarAntesDeIrAGastos()" disabled>Gastos</button>
  <button id="btnActivos" class="nav-btn" onclick="validarAntesDeIrAActivos()" disabled>Activos</button>
  <button id="btnPasivos" class="nav-btn" onclick="validarAntesDeIrAPasivos()" disabled>Pasivos</button>
  <button id="btnRetiro" class="nav-btn" onclick="validarAntesDeIrARetiro()" disabled>Retiro</button>
</div>

<!-- ğŸ”¹ FORMULARIO: Step Ingresos -->
<div class="step active" id="stepIngresos">
  <fieldset>
    <legend>Ingresos y Ahorros</legend>

    <label for="ingreso_bruto">Ingreso anual bruto
      <span class="tooltip" tabindex="0" data-tooltip="Suma total de ingresos antes de impuestos: salario, negocio, bonos, dividendos, rentas, etc.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="ingreso_bruto" name="ingreso_bruto" required onblur="validarCampo(this)">

    <label for="aporte_personal_retiro">Aporte personal a retiro
      <span class="tooltip" tabindex="0" data-tooltip="Aporte que realizas de tu salario hacia tu fondo de retiro 401k, IRA, o similar.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="aporte_personal_retiro" name="aporte_personal_retiro" required onblur="validarCampo(this)">

    <label for="aporte_empleador_retiro">Aporte del empleador a retiro
      <span class="tooltip" tabindex="0" data-tooltip="Aporte que tu empleador realiza a tu fondo de retiro, si aplica.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="aporte_empleador_retiro" name="aporte_empleador_retiro" required onblur="validarCampo(this)">

    <label for="otros_ahorros">Otros ahorros
      <span class="tooltip" tabindex="0" data-tooltip="Cualquier otra forma de ahorro anual: ahorro bancario, fondos de emergencia, etc.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="otros_ahorros" name="otros_ahorros" required onblur="validarCampo(this)">
  </fieldset>

  <div class="nav-buttons">
    <button type="button" onclick="validarIngresoYActivarGastos()">Continuar</button>
  </div>
</div>
  
  <!-- 2. Gastos -->
<div class="step" id="stepGastos">
  <fieldset>
    <legend>Gastos Anuales</legend>

    <label for="pago_deudas">Pago por deudas
      <span class="tooltip" data-tooltip="Pagos anuales de hipotecas, prÃ©stamos personales, automotrices, educativos y tarjetas de crÃ©dito.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="pago_deudas" name="pago_deudas" required onblur="validarCampo(this)">

    <label for="gastos_diarios">Gastos diarios esenciales
      <span class="tooltip" data-tooltip="Incluye supermercado, transporte, servicios pÃºblicos, telecomunicaciones y mantenimiento bÃ¡sico.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="gastos_diarios" name="gastos_diarios" required onblur="validarCampo(this)">

    <label for="impuestos_anuales">Impuestos anuales
      <span class="tooltip" data-tooltip="Pagos de impuestos federales, seguro social, medicare, impuestos estatales, municipales, de propiedad y de vehÃ­culo.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="impuestos_anuales" name="impuestos_anuales" required onblur="validarCampo(this)">

    <label for="seguros_anuales">Seguros anuales
      <span class="tooltip" data-tooltip="Pagos de seguros de salud, vida, propiedad, auto y umbrella.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="seguros_anuales" name="seguros_anuales" required onblur="validarCampo(this)">
  </fieldset>
      <div class="nav-buttons">
      <button type="button" onclick="validarGastosYActivarActivos()">Continuar</button>
    </div>
</div>

  <!-- 3. Activos -->
<div class="step" id="stepActivos">
  <fieldset>
    <legend>Activos</legend>

    <label for="efectivo_similar">Efectivo y similares
      <span class="tooltip" data-tooltip="Cuentas bancarias, efectivo, money market.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="efectivo_similar" name="efectivo_similar" required onblur="validarCampo(this)">

    <label for="cuentas_inversion">Cuentas de inversiÃ³n (no retiro)
      <span class="tooltip" data-tooltip="Fondos mutuos, acciones, bonos.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="cuentas_inversion" name="cuentas_inversion" required onblur="validarCampo(this)">

    <label for="cuentas_retiro">Cuentas de retiro
      <span class="tooltip" data-tooltip="401(k), IRA, Roth, etc.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="cuentas_retiro" name="cuentas_retiro" required onblur="validarCampo(this)">

    <label for="valor_propiedades">Propiedades
      <span class="tooltip" data-tooltip="Valor de tus viviendas o propiedades de inversiÃ³n.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="valor_propiedades" name="valor_propiedades" required onblur="validarCampo(this)">

    <label for="otros_activos">Otros activos
      <span class="tooltip" data-tooltip="Autos, joyas, arte, etc.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="otros_activos" name="otros_activos" required onblur="validarCampo(this)">

    <div class="nav-buttons">
      <button type="button" onclick="validarActivosYActivarPasivos()">Continuar</button>
    </div>
  </fieldset>
</div>

  <!-- 4. Pasivos -->
<div class="step" id="stepPasivos">
  <fieldset>
    <legend>Pasivos</legend>

    <label for="deuda_tarjetas">Deuda de tarjetas de crÃ©dito
      <span class="tooltip" data-tooltip="Saldo total actual de todas tus tarjetas de crÃ©dito.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="deuda_tarjetas" name="deuda_tarjetas" required onblur="validarCampo(this)">

    <label for="deuda_hipotecaria">Hipoteca o prÃ©stamo de vivienda
      <span class="tooltip" data-tooltip="Saldo pendiente de tu hipoteca principal o prÃ©stamo de vivienda.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="deuda_hipotecaria" name="deuda_hipotecaria" required onblur="validarCampo(this)">

    <label for="deuda_comercial">Deuda comercial
      <span class="tooltip" data-tooltip="Saldo actual de prÃ©stamos comerciales si eres dueÃ±o de un negocio.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="deuda_comercial" name="deuda_comercial" required onblur="validarCampo(this)">

    <label for="deuda_vehiculos">PrÃ©stamos de vehÃ­culos
      <span class="tooltip" data-tooltip="Saldo pendiente de tus prÃ©stamos de autos, motocicletas u otros vehÃ­culos.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="deuda_vehiculos" name="deuda_vehiculos" required onblur="validarCampo(this)">

    <label for="deuda_estudios">Deuda estudiantil
      <span class="tooltip" data-tooltip="Saldo restante de tus prÃ©stamos educativos o universitarios.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="deuda_estudios" name="deuda_estudios" required onblur="validarCampo(this)">

    <label for="deuda_otros">Otras deudas
      <span class="tooltip" data-tooltip="Cualquier otro saldo de deuda no clasificada anteriormente.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="deuda_otros" name="deuda_otros" required onblur="validarCampo(this)">

  </fieldset>
  <div class="nav-buttons">
    <button type="button" onclick="validarPasivosYActivarRetiro()">Continuar</button>
  </div>
</div>
  
<!-- 5. Retiro -->
<div class="step" id="stepRetiro">
  <fieldset>
    <legend>PlanificaciÃ³n de retiro</legend>

    <label for="edad">
      Edad actual
      <span class="tooltip" data-tooltip="Tu edad en este momento. Es el punto de partida para calcular tu plan de retiro.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="edad" name="edad" required onblur="validarCampo(this)">

    <label for="edad_retiro">
      Edad deseada de retiro
      <span class="tooltip" data-tooltip="La edad a la cual planeas retirarte. ComÃºnmente entre 60 y 70 aÃ±os.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="edad_retiro" name="edad_retiro" required onblur="validarCampo(this)">

    <label for="tasa_acumulacion">
      Tasa esperada de acumulaciÃ³n (%) 
      <span class="tooltip" data-tooltip="Tasa de crecimiento promedio anual de tus inversiones hasta el retiro. Ejemplo tÃ­pico: 7%-10%.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="tasa_acumulacion" name="tasa_acumulacion" step="0.01" required onblur="validarCampo(this)">

    <label for="inflacion_esperada">
      InflaciÃ³n estimada (%) 
      <span class="tooltip" data-tooltip="Incremento promedio esperado de los precios cada aÃ±o. Ejemplo tÃ­pico: 2%-3%.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="inflacion_esperada" name="inflacion_esperada" step="0.01" required onblur="validarCampo(this)">

    <label for="tasa_retiro">
      Tasa estimada durante retiro (%) 
      <span class="tooltip" data-tooltip="Rendimiento esperado de tus inversiones despuÃ©s de retirarte. Ejemplo tÃ­pico: 3%-5%.">ğŸ›ˆ</span>
    </label>
    <input type="number" id="tasa_retiro" name="tasa_retiro" step="0.01" required onblur="validarCampo(this)">

    <!-- Tasa de reemplazo oculta -->
    <input type="hidden" name="porcentaje_reemplazo" value="70">
  </fieldset>
  <div class="nav-buttons">
    <button type="button" onclick="calcularYMostrar()">Calcular</button>
  </div>
</div>
  
<!-- ğŸ§¾ Contenedor de resultados -->
<div id="resultadosContainer" style="display:none;">
  <h2>ğŸ§® Resultado Calculado</h2>
<!-- ğŸ”µ Contenedor de Resultados -->
<div id="navResultados">
  <button class="nav-btn" onclick="mostrarResultado('resA')">ğŸ…° Liquidez</button>
  <button class="nav-btn" onclick="mostrarResultado('resB')">ğŸ…± Deuda</button>
  <button class="nav-btn" onclick="mostrarResultado('resC')">ğŸ…² Patrimonio Neto</button>
  <button class="nav-btn" onclick="mostrarResultado('resD')">ğŸ…³ Seguridad Financiera</button>
  <button class="nav-btn" onclick="mostrarResultado('resE')">ğŸ…´ Manejo de riesgo</button>
  <button class="nav-btn" onclick="mostrarResultado('resF')">ğŸ…µ Futuro</button>
  <button class="nav-btn" onclick="mostrarResultado('resG')">ğŸ…µ Examen de EstÃ©s</button>
</div>
  <!-- ğŸ…° Liquidez -->
<div id="resA" class="resultado-categoria">
    <p>ğŸ“˜ Resultado C (placeholder â€“ aÃºn no implementado)</p>
  </div>

  <!-- ğŸ…± Endeudamiento -->
<div id="resB" class="resultado-categoria">
  <h4>ğŸ…± Indicadores de Endeudamiento</h4>
  <table class="tabla-resultados">
    <thead>
      <tr>
        <th>Indicador</th>
        <th>Resultado</th>
        <th>Benchmark</th>
        <th>ExplicaciÃ³n</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Pago de deuda / ingreso bruto</td>
        <td id="b_dti_ingreso">--</td>
        <td>â‰¤ 30% âœ… Â· > 30% ğŸš¨</td>
        <td>Porcentaje del ingreso bruto destinado a todas las deudas</td>
      </tr>
      <tr>
        <td>Deudas / activos totales</td>
        <td id="b_deuda_activos">--</td>
        <td>â‰¤ 50% âœ… Â· > 50% âš ï¸</td>
        <td>ProporciÃ³n de deuda total sobre activos</td>
      </tr>
      <tr>
        <td>Deudas / patrimonio neto</td>
        <td id="b_deuda_patrimonio">--</td>
        <td>â‰¤ 50% âœ… Â· 51â€“100% âš ï¸ Â· > 100% ğŸš¨</td>
        <td>ComparaciÃ³n entre lo que debes y tu patrimonio</td>
      </tr>
    </tbody>
  </table>
</div>

  
  <!-- ğŸ…² Patrimonio Neto -->
  <div id="resC" class="resultado-categoria">
    <p>ğŸ’° Resultado C (placeholder â€“ aÃºn no implementado)</p>
  </div>

  <!-- ğŸ…³ Seguridad Financiera -->
  <div id="resD" class="resultado-categoria">
    <!-- Este serÃ¡ llenado dinÃ¡micamente por mostrarResultadoPasivos -->
  </div>
</div>

  <!-- ğŸ…´ Manejo de Riesgo -->
<div id="resE" class="resultado-categoria">
  <!-- Se llenarÃ¡ dinÃ¡micamente -->
</div>
  
<!-- F Retiro -->
<div id="resF" class="resultado-categoria">
  <h4>ğŸ…µ EvaluaciÃ³n de Futuro Financiero</h4>
  <table class="tabla-resultados">
    <thead>
      <tr>
        <th>Ãtem</th>
        <th>Resultado</th>
        <th>EvaluaciÃ³n</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>ğŸ§± Capital necesario</td>
        <td id="g_capital_requerido">--</td>
        <td>â€”</td>
      </tr>
      <tr>
        <td>ğŸ’¼ Total acumulado estimado</td>
        <td id="g_capital_estimado">--</td>
        <td>â€”</td>
      </tr>
      <tr>
        <td>âš ï¸ Faltante actual</td>
        <td id="g_faltante">--</td>
        <td id="g_eval_faltante">--</td>
      </tr>
      <tr>
        <td>ğŸ’¸ Aporte anual recomendado</td>
        <td id="g_aporte_anual">--</td>
        <td>â€”</td>
      </tr>
      <tr>
        <td>ğŸ’° Aporte mensual recomendado</td>
        <td id="g_aporte_mensual">--</td>
        <td>â€”</td>
      </tr>
      <tr>
        <td>ğŸ“ Factor de ahorro por edad</td>
        <td id="g_factor_ahorro">--</td>
        <td id="g_eval_factor">--</td>
      </tr>
    </tbody>
  </table>
  <!-- ğŸ“Š GrÃ¡fico comparativo -->
  <div style="margin-top: 20px;">
  <canvas id="graficoFuturo" height="220"></canvas>

    <!-- ğŸ…¶ Pruebas de EstrÃ©s -->
<div id="resG" class="resultado-categoria">
  <h4>ğŸ…¶ EvaluaciÃ³n de Pruebas de EstrÃ©s</h4>
  <table class="tabla-resultados">
    <thead>
      <tr>
        <th>Escenario</th>
        <th>Â¿Cubre gastos?</th>
        <th>Â¿Cubre deudas?</th>
        <th>Â¿Sigue ahorrando?</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Leve (-10%)</td>
        <td id="g_gastos_leve">--</td>
        <td id="g_deuda_leve">--</td>
        <td id="g_ahorro_leve">--</td>
      </tr>
      <tr>
        <td>Moderado (-30%)</td>
        <td id="g_gastos_moderado">--</td>
        <td id="g_deuda_moderado">--</td>
        <td id="g_ahorro_moderado">--</td>
      </tr>
      <tr>
        <td>Severo (-50%)</td>
        <td id="g_gastos_severo">--</td>
        <td id="g_deuda_severo">--</td>
        <td id="g_ahorro_severo">--</td>
      </tr>
    </tbody>
  </table>

  <p style="font-size: 0.9em; margin-top: 12px;">
    ğŸ“ <strong>Notas:</strong><br>
    â€¢ SimulaciÃ³n basada en caÃ­da del 10%, 30%, y 50% de ingresos y activos no lÃ­quidos.<br>
    â€¢ Efectivo y equivalentes no se afectan en la simulaciÃ³n.
  </p>
</div>
<!-- âœ… Script externo cargado al final -->
<script src="script.js"></script>
</body>
</html>
