<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <title>Calculadora Financiera</title>
  <!-- ConexiÃ³n al CSS externo -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
<!-- ðŸ”¹ FORMULARIO: Step Ingresos -->
<div class="step active" id="stepIngresos">
  <fieldset>
    <legend>Ingresos y Ahorros</legend>

    <label for="ingreso_bruto">Ingreso anual bruto
      <span title="Suma total de ingresos antes de impuestos">ðŸ›ˆ</span>
    </label><br>
    <input type="number" id="ingreso_bruto" name="ingreso_bruto" required onblur="validarCampo(this)"><br><br>

    <label for="aporte_personal_retiro">Aporte personal a retiro
      <span title="Aporte de tu salario a tu fondo de retiro">ðŸ›ˆ</span>
    </label><br>
    <input type="number" id="aporte_personal_retiro" name="aporte_personal_retiro" required onblur="validarCampo(this)"><br><br>

    <label for="aporte_empleador_retiro">Aporte del empleador a retiro
      <span title="Aporte de tu empleador a tu fondo de retiro">ðŸ›ˆ</span>
    </label><br>
    <input type="number" id="aporte_empleador_retiro" name="aporte_empleador_retiro" required onblur="validarCampo(this)"><br><br>

    <label for="otros_ahorros">Otros ahorros
      <span title="Ahorros bancarios, fondos, etc.">ðŸ›ˆ</span>
    </label><br>
    <input type="number" id="otros_ahorros" name="otros_ahorros" required onblur="validarCampo(this)"><br><br>

    <div class="nav-buttons">
      <button type="button" onclick="mostrarResultadoBasico()">Calcular</button>
    </div>
  </fieldset>
</div>

<!-- ðŸ”µ Contenedor de Resultados -->
<div id="resultadosContainer" style="display: none;">
  <h2>ðŸŸ© Resultado Calculado</h2>
  <div id="resA" class="resultado-categoria">
    <p id="resultadoBasico">Resultado aÃºn no calculado.</p>
  </div>
</div>
    
  <!-- ðŸ”µ Contenedor de Resultados -->
  <div id="resultadosContainer">
    <h2>ðŸŸ© Resultado Calculado</h2>
    <div id="resA" class="resultado-categoria">
      <p id="resultadoBasico">Resultado aÃºn no calculado.</p>
    </div>
  </div>

<script>
  function validarCampo(input) {
    const valor = parseFloat(input.value);
    if (isNaN(valor) || valor < 0) {
      input.style.borderColor = "red";
    } else {
      input.style.borderColor = "#44008f";
    }
  }

  function guardarDatosYAvanzar(idSiguientePaso) {
    mostrarResultadoBasico();
    irASeccion(idSiguientePaso);
  }

  function mostrarResultadoBasico() {
    const ingresoBruto = parseFloat(document.getElementById("ingreso_bruto").value) || 0;
    const aportePersonal = parseFloat(document.getElementById("aporte_personal_retiro").value) || 0;
    const aporteEmpleador = parseFloat(document.getElementById("aporte_empleador_retiro").value) || 0;
    const otrosAhorros = parseFloat(document.getElementById("otros_ahorros").value) || 0;
    const totalAhorros = aportePersonal + aporteEmpleador + otrosAhorros;
    const tasaAhorro = ingresoBruto > 0 ? (totalAhorros / ingresoBruto) * 100 : 0;

    const html = `
      <p><strong>Ingreso anual bruto:</strong> $${ingresoBruto.toLocaleString()}</p>
      <p><strong>Aporte personal a retiro:</strong> $${aportePersonal.toLocaleString()}</p>
      <p><strong>Aporte del empleador:</strong> $${aporteEmpleador.toLocaleString()}</p>
      <p><strong>Otros ahorros:</strong> $${otrosAhorros.toLocaleString()}</p>
      <p><strong>Total de ahorros:</strong> $${totalAhorros.toLocaleString()}</p>
      <p><strong>Tasa de ahorro:</strong> ${tasaAhorro.toFixed(1)}%</p>
    `;

    document.getElementById("resultadoBasico").innerHTML = html;
    document.getElementById("resultadosContainer").style.display = "block";
  }

  function irASeccion(id) {
    const pasos = document.querySelectorAll(".step");
    pasos.forEach(p => p.classList.remove("active"));
    const pasoActual = document.getElementById(id);
    if (pasoActual) pasoActual.classList.add("active");
  }

  document.addEventListener("DOMContentLoaded", () => {
    irASeccion("stepIngresos");
  });
</script>


</body>
</html>
